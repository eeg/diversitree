2010-01-05  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* R/simulate-bisse.R (make.tree.bisse): Fixed creation of empty
	history objects.

	* R/history.R (plot.history.coords): Fixed plotting history
	objects where nothing happened.

	* R/simulation.R (prune.hist): Fix for history plotting where
	changes occur along a branch leading to the reconstructed root
	when the branch is erased by extinction.

	* R/mle.R: Moved do.mle.search around to make file easier to
	navigate.  New coef.fit.mle method for extracting parameters from
	ML fits.

	* R/model-bd.R: Renamed bd.ll -> ll.bd for consistency with other
	functions.

	* R/model-bisse.R: Reordered arguments of ll.bisse to match those
	of ll.xxsse.

2010-01-04  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* R/model-bisse.R (branches.unresolved.bisse): Switch
	log-compensation to the sum of variables (rather than minimum of
	variables) to avoid a crash on Linux (stack smashing) and an
	excessive number of warnings on other platforms.
	
	* R/model-bisse.R (make.branches.bisse): make.ode for the branch
	integration is now done during make.bisse.  Added new "safe"
	argument to make.bisse that selects how this should be done.
	Eventually all lsoda based likelihood functions will get a "safe"
	argument.

	* man/make.bisse.Rd: Added "safe" argument.

	* R/zzz.R: Removed .onLoad function; no longer needed with
	make.ode moved inside of make.bisse.

	* R/util.R (make.ode): Updated make.ode to work with deSolve
	version 1.6 (two new additional arguments).  The "safe" version
	now returns same data format as the unsafe version.

	* R/model-mkn.R (argnames.mk2): Fixed logic around argument names
	for mk2 and two-state mkn (latter now returns q12, q21)

	* R/simulate-bd.R (tree.yule): New Yule tree simulation function
	that uses the existing tree.bd with mu = 0.  Required changes also
	to R/simulation.R and man/simulation.Rd.

	* R/mle.R, R/mcmc.R and all likeihood functions: Shifted protect()
	from within every likelihood functions into the new mle interface
	and MCMC functions directly.  This removes significant code
	duplication, simplifies creation of new likelihood functions, and
	means we can always depend on fail.value existing.

	* R/model-bd.R (find.mle.yule): Added support for Yule models.
	These are nice as the ML parameters are findable analytically.

2009-12-21  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* Too many little changes to list

	* R/plot-alt.R: New plotting functions, partially duplicating
	ape's plot function to allow stochastic character map type plots
	to be drawn.  I am attempting to retain as much compatibility with
	ape as possible and only using these commands within high-level
	plots.

	* R/history.R: Functions for storing and plotting phylogenetic
	histories.  The simulation code now stores exactly when changes
	occured and can plot the full character history.

	* R/find.mle.R: Continuing to revamp the find.mle code.  Different
	back ends now abstracted (though new ones cannot be added without
	recompiling the package).  Further changes coming though.

	* R/model-mkn.R: Uses the general log-compensation feature now.

	* R/util.R: New function discretize, which is useful for binning
	continuous characters into discrete characters (possibly for
	making colour codes).  Probably will change soon.

	* man/plot.history.Rd: Documentation for histories

2009-12-02  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* R/simulation.R (tree.bisse): Fix to tree simulation code to
	store node states.  This requires fix to ape's drop.tip function.

2009-12-01  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* R/util.R (invert): New function invert for returning the inverse
	of the log-likelihood.

	* R/model-bd.R: Simple birth-death process estimation.  This does
	not yet allow for sampling fractions or unresolved clades, but
	these will be added soon.  MLE routines are also included.

	* R/model-mkn.R: Simple Mk2/Mk-n discrete character evolution.
	This directly duplicates the 'ace' function in ape, but should
	allow some additional flexibility.

	* R/find.mle.R (find.mle.bisse): Removed default 'lower'
	specificiation as this was causing more confusion than helping
	anybody.  Using fail.value will get around more problems,
	including invalid models because of invalid lower/upper.  This may
	cause some problems where a hard lower bound is preferred to get
	exact solutions.

2009-11-30  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* R/mcmc.R (mcmc): Added checking that the initial position has
	positive probability.  Also added 'verbose' flag to make MCMC
	searches quieter.

	* R/model-bisse.R (branches.bisse): Recursive algorithm to reduce
	the probability of numerical underflow along unlikely branches.
	This will overflow the stack sometimes though.

	* General: rewrite of the calculation functions to allow new
	models to be more easily developed.  This may cause a slight
	slowdown, unfortunately.

2009-10-22  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* R/util.R (protect): Switch from trySilent to try(...,
	silent=TRUE) in anticipation of R 2.10's deprecation of
	trySilent.

	* R/util.R (make.ode): Fixed bug that caused integration to fail
	with deSolve version 1.5 (added 'flist' parameter).

2009-10-14  Rich FitzJohn  <fitzjohn@zoology.ubc.ca>

	* New formula-based constraint interface (through function
	constrain())

	* Subplex available to do ML searches

	* Standard error estimates on ML estimates
